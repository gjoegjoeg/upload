<!DOCTYPE html>

<html>

<head>
<style>


</style>
</head>

<body> 
  <div>
    <button id="bt1">Turn off</button>
    <button id="bt2">Easy mode</button>
    <img src="https://i.imgur.com/omX5Drl.png" style="position:absolute;top:0vw;left:0vw;width:70vw;z-index:-1">
  </div>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>  
<script>
class Light {
  
  constructor(posx, posy) {
  	// create/append div dynamically
    // https://stackoverflow.com/questions/14004117/create-div-and-append-div-dynamically
    this.element = document.createElement ('div');
    //this = iDiv;
    this.element.id = 'light';
    // set element style attribute
    //https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/style
    this.element.style.cssText = "position:absolute;width:20px;height:20px;border-radius:15px;z-index:1"; 
	  this.element.style.top = posx+'vw';
    this.element.style.left = posy+'vw';
    // CSS color property: https://www.w3schools.com/cssref/pr_text_color.asp
    // hsl: https://www.w3schools.com/colors/colors_hsl.asp
    this.element.style.background = "hsl(89, 43%, 51%)";
    document.getElementsByTagName('body')[0].appendChild(this.element);
  }

	changeColor() {
  	// https://stackoverflow.com/questions/45147661/javascript-recursion-within-a-class/45147713
    var self = this;
    
  	  var hue = Math.random()*200;
    if(toggle == true){
  	  self.element.style.background = "hsl(" + hue + ", 43%, 51%)";
      
    }
    else{
      self.element.style.background = "hsl(10, 10%, 10%)";
    }
    if(toggleMode == true){
      var randomTime = Math.random()*1000+1000;
      setTimeout (function() { self.changeColor() } , randomTime);
    }
    else{
      setTimeout (function() { self.changeColor() } , 500);
    }
		// setTimeout ( self.changeColor , 1000);  // why this is not working ...
  }
 
}

////////////////////////////////
var toggle = false;
$('#bt1').click(function(){
  toggle = !toggle;
  if(toggle == true){
    $("#bt1").text("Turn on");
  }
  else{ 
    $("#bt1").text("Turn off");
  }
});

var toggleMode = false;
$('#bt2').click(function(){
  toggleMode = !toggleMode;
  if(toggleMode == true){
    $("#bt2").text("Complex mode");
  }
  else{ 
    $("#bt2").text("Easy mode");
  }
});
///////////////////////////////
init();

function init() {
  
  let light = new Light(10, 30);
  light.changeColor();
  let light1 = new Light(20, 20);
  light1.changeColor();
  let light2 = new Light(25, 35);
  light2.changeColor();
  let light3 = new Light(27, 30);
  light3.changeColor();
  let light4 = new Light(17, 38);
  light4.changeColor();
  let light5 = new Light(32, 42);
  light5.changeColor();
  let light6 = new Light(33, 15);
  light6.changeColor();
  let light7 = new Light(37, 24);
  light7.changeColor();
  let light8 = new Light(40, 40);
  light8.changeColor();
  let light9 = new Light(45, 29);
  light9.changeColor();
}
</script>
</body>

</html>